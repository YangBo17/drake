--- src/sys/objects/inherit.c
+++ src/sys/objects/inherit.c
@@ -3,6 +3,7 @@
 */
 #include <petsc/private/petscimpl.h> /*I   "petscsys.h"    I*/
 #include <petscviewer.h>
+#include <stdatomic.h>

 #if defined(PETSC_USE_LOG)
 PETSC_INTERN PetscObject *PetscObjects;
@@ -24,8 +25,8 @@ PETSC_EXTERN PetscErrorCode PetscObjectQueryFunction_Petsc(PetscObject, const ch

 PetscObjectId PetscObjectNewId_Internal(void)
 {
-  static PetscObjectId idcnt = 1;
-  return idcnt++;
+  static atomic_int atomic_idcnt = 1;
<<<<<<< HEAD
+  return atomic_fetch_add(&atomic_idcnt, 1);
 }

 /*
=======
 #if defined(PETSC_USE_LOG)
   PetscObject     *newPetscObjects;
   PetscInt         newPetscObjectsMaxCounts,i;
@@ -47,7 +48,7 @@ PetscErrorCode  PetscHeaderCreate_Private(PetscObject h,PetscClassId classid,con
 #if defined(PETSC_HAVE_SAWS)
   h->amsmem                = PETSC_FALSE;
 #endif
-  h->id                    = idcnt++;
+  h->id                    = atomic_fetch_add(&atomic_idcnt, 1);
   h->parentid              = 0;
   h->qlist                 = NULL;
   h->olist                 = NULL;
>>>>>>> 39291320815eca6c872c9ce0a595d643d0acf87c
